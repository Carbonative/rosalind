_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[8],{CaRH:function(e,n,t){"use strict";t.r(n);var r=t("nKUr"),c=t("o0o1"),a=t.n(c),i=t("HaE+"),s=t("q1tI"),o=t("leFc"),l={maxWidth:"25%",height:"auto",outline:0,margin:3},d="undefined"!==typeof document&&"download"in document.createElement("a");n.default=function(e){var n=e.token,t=Object(s.useState)(!0),c=t[0],u=t[1],b=Object(s.useState)(!1),h=b[0],j=b[1],p=Object(s.useState)(!0),m=p[0],O=p[1],f=Object(s.useState)([]),x=f[0],g=f[1];Object(s.useEffect)(Object(i.a)(a.a.mark((function e(){var t,r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j(null),u(!0),t=JSON.stringify({token:n}),e.next=6,fetch((o.a||"")+"/portal/media",{method:"POST",headers:{"content-type":"application/json","content-length":t.length},body:t});case 6:return r=e.sent,e.next=9,r.json();case 9:c=e.sent,u(!1),c.error?j(c.error):g(c),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),u(!1),j(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,14]])}))),[n,m]);var S=function(e){var n=e.filename,t=e.b64,r=e.mediaType;console.log("saveasfile",n,t.substr(0,100));var c=document.createElement("a");c.download=n,t.startsWith("data:")||(t="data:"+r+";base64,"+t),c.href=t,c.click()},v=function(){var e=Object(i.a)(a.a.mark((function e(t){var r,c,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(null),e.prev=1,r=JSON.stringify({token:n,_id:t._id}),e.next=5,fetch((o.a||"")+"/portal/media-download",{method:"POST",headers:{"content-type":"application/json","content-length":r.length},body:r});case 5:return c=e.sent,e.next=8,c.json();case 8:i=e.sent,u(!1),i.error?(console.error(i),j(i.error)):(j(null),console.log("saving"),S({filename:i.filename,mediaType:i.mediaType,b64:i.b64})),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(1),console.error(e.t0),u(!1),j(e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(n){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:"Sie k\xf6nnen die Bilder innerhalb von 14 Tagen abspeichern."}),d?Object(r.jsx)("p",{children:"Tippen Sie auf ein Bild, um es zu speichern."}):Object(r.jsx)("p",{children:"Tippen Sie auf ein Bild und halten Sie gedr\xfcckt, um es zu speichern."}),Object(r.jsx)("button",{onClick:function(e){e.preventDefault(),e.stopPropagation();for(var n=0;n<x.length;n++)document.getElementById("link-"+x[n]._id).click()},children:"Alle Bilder speichern"}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),h&&Object(r.jsxs)("div",{children:["Fehler: ",h.toString()]}),c&&Object(r.jsx)("div",{children:"Einen Moment bitte, Bilder werden geladen..."}),(x||[]).map((function(e){return Object(r.jsx)("a",{id:"link-"+e._id,title:e.title,href:"#",onClick:function(){return v(e)},children:Object(r.jsx)("img",{style:l,alt:e.title,src:e.preview})},e._id)})),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("a",{href:"#",onClick:function(){return O(m+1)},children:"Neu laden"})]})}},O2ls:function(e,n,t){"use strict";t.r(n);var r=t("nKUr"),c=t("o0o1"),a=t.n(c),i=t("HaE+"),s=t("Ff2n"),o=t("q1tI"),l=t("KYPV"),d=t("EbeW"),u=t("CaRH"),b=t("leFc"),h=function(e){var n=e.onSuccess,t=Object(s.a)(e,["onSuccess"]),c=Object(o.useState)(null),u=c[0],h=c[1],j=Object(o.useState)(!1),p=j[0],m=j[1];return Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(l.c,{initialValues:{firstName:"",lastName:"",insuranceId:"",twoFactorCode:""},onSubmit:function(){var e=Object(i.a)(a.a.mark((function e(t,r){var c,i,s,o,l,d,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=r.setSubmitting,console.log(t),h(null),c(!0),!p){e.next=25;break}return e.prev=5,i=JSON.stringify({code:t.twoFactorCode,insuranceId:t.insuranceId,firstName:t.firstName,lastName:t.lastName}),e.next=9,fetch((b.a||"")+"/portal/two-factor",{method:"POST",headers:{"content-type":"application/json","content-length":i.length},body:i});case 9:return s=e.sent,e.next=12,s.json();case 12:o=e.sent,c(!1),o.token&&n(o.token),o.error&&h(o.error),console.log("res2",o),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(5),c(!1),h(e.t0);case 23:e.next=42;break;case 25:return e.prev=25,l=JSON.stringify({insuranceId:t.insuranceId,firstName:t.firstName,lastName:t.lastName}),e.next=29,fetch((b.a||"")+"/portal/login",{method:"POST",headers:{"content-type":"application/json","content-length":l.length},body:l});case 29:return d=e.sent,e.next=32,d.json();case 32:u=e.sent,c(!1),m(!0),console.log("res",u),e.next=42;break;case 38:e.prev=38,e.t1=e.catch(25),c(!1),h(e.t1);case 42:case"end":return e.stop()}}),e,null,[[5,19],[25,38]])})));return function(n,t){return e.apply(this,arguments)}}(),children:function(e){var n=e.values,c=e.isSubmitting,a=(e.handleChange,e.resetForm);return Object(r.jsx)(r.Fragment,{children:p?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h2",{children:"Best\xe4tigung per SMS"}),Object(r.jsx)("p",{children:"Bitte geben Sie den 5-stelligen Code ein, der Ihnen per SMS zugesandt wurde."}),Object(r.jsxs)(l.b,{method:"POST",children:[Object(r.jsx)(d.b,{name:"twoFactorCode",label:"Einmal-Code (5 Stellen)",required:!0,placeholder:"0 0 0 0 0",options:{numericOnly:!0,blocks:[1,1,1,1,1],delimiter:" "}}),u&&Object(r.jsx)("p",{children:Object(r.jsx)("b",{children:"".concat(u)})}),Object(r.jsx)("input",{disabled:c||!(5===n.twoFactorCode.length),className:"button",type:"submit",value:"Einloggen"}),Object(r.jsx)("p",{className:"text-muted pt3",children:"Wenn Sie nach 5 Minuten noch keinen Code erhalten haben, \xfcberpr\xfcfen Sie Ihre Eingaben auf der vorherigen Seite oder kontaktieren Sie die Ordination."}),Object(r.jsx)("a",{href:"#",onClick:function(){a(),h(null),m(!1)},children:"< Zur\xfcck"})]})]}):Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:t.welcome||"Sehr geehrte Patientin, sehr geehrter Patient!"}),Object(r.jsx)("p",{children:t.instructions||"\xdcber dieses Formular k\xf6nnen Sie die im Rahmen Ihrer Untersuchung oder Behandlung angefertigten Bilder und Befunde bis zu 14 Tage lang nach Ihrem Termin einsehen. Melden Sie sich dazu mit ihren in der Ordination best\xe4tigten Daten an."}),Object(r.jsxs)(l.b,{method:"POST",children:[Object(r.jsx)(d.d,{name:"firstName",label:"Vorname",required:!0}),Object(r.jsx)(d.d,{name:"lastName",label:"Nachname",required:!0}),Object(r.jsx)(d.b,{name:"insuranceId",label:"Sozialversicherungsnummer (10 Stellen)",required:!0,pattern:"[0-9\\s]+",placeholder:"0000 000000",options:{numericOnly:!0,blocks:[4,6],delimiter:" "}}),u&&Object(r.jsx)("p",{children:Object(r.jsx)("b",{children:"".concat(u)})}),Object(r.jsx)("input",{disabled:c||!(n.firstName&&n.lastName&&n.insuranceId&&10===n.insuranceId.length),className:"button",type:"submit",value:"Einloggen"})]})]})})}})})};n.default=function(){var e=Object(o.useState)(null),n=e[0],t=e[1];return n?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h1",{children:"Ihre Befunde und Bilder"}),Object(r.jsx)(u.default,{token:n}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("a",{href:"#",onClick:function(e){window.location.reload()},children:"Ausloggen"})]}):Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(h,{onSuccess:t})})}},u6Hu:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return t("O2ls")}])}},[["u6Hu",0,2,1,3]]]);