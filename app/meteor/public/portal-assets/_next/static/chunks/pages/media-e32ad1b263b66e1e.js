(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[361],{4482:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/media",function(){return t(4471)}])},5958:function(e,n,t){"use strict";t.d(n,{n:function(){return i}});let i="https:"===window.location.protocol?"":"http://10.0.0.69:3000";console.log(i)},4471:function(e,n,t){"use strict";t.r(n);var i=t(5893),l=t(7294),r=t(5958);let o={maxWidth:"25%",height:"auto",outline:0,margin:3},a="undefined"!=typeof document&&"download"in document.createElement("a");n.default=e=>{let{token:n}=e,[t,s]=(0,l.useState)(!0),[c,d]=(0,l.useState)(!1),[u,h]=(0,l.useState)(!0),[p,f]=(0,l.useState)([]);(0,l.useEffect)(()=>{!async function(){try{d(null),s(!0);let e=JSON.stringify({token:n}),t=await fetch((r.n||"")+"/portal/media",{method:"POST",headers:{"content-type":"application/json","content-length":e.length},body:e}),i=await t.json();s(!1),i.error?d(i.error):f(i)}catch(e){s(!1),d(e)}}()},[n,u]);let m=e=>{let{filename:n,b64:t,mediaType:i}=e;console.log("saveasfile",n,t.substr(0,100));let l=document.createElement("a");l.download=n,t.startsWith("data:")||(t="data:"+i+";base64,"+t),l.href=t,l.click()},g=async e=>{d(null);try{let t=JSON.stringify({token:n,_id:e._id}),i=await fetch((r.n||"")+"/portal/media-download",{method:"POST",headers:{"content-type":"application/json","content-length":t.length},body:t}),l=await i.json();s(!1),l.error?(console.error(l),d(l.error)):(d(null),console.log("saving"),m({filename:l.filename,mediaType:l.mediaType,b64:l.b64}))}catch(e){console.error(e),s(!1),d(e)}};return(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{children:"Sie k\xf6nnen die Bilder innerhalb von 14 Tagen abspeichern."}),a?(0,i.jsx)("p",{children:"Tippen Sie auf ein Bild, um es zu speichern."}):(0,i.jsx)("p",{children:"Tippen Sie auf ein Bild und halten Sie gedr\xfcckt, um es zu speichern."}),(0,i.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation();for(let e=0;e<p.length;e++)document.getElementById("link-"+p[e]._id).click()},children:"Alle Bilder speichern"}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),c&&(0,i.jsxs)("div",{children:["Fehler: ",c.toString()]}),t&&(0,i.jsx)("div",{children:"Einen Moment bitte, Bilder werden geladen..."}),(p||[]).map(e=>(0,i.jsx)("a",{id:"link-"+e._id,title:e.title,href:"#",onClick:()=>g(e),children:(0,i.jsx)("img",{style:o,alt:e.title,src:e.preview})},e._id)),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsx)("a",{href:"#",onClick:()=>h(u+1),children:"Neu laden"})]})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=4482)}),_N_E=e.O()}]);